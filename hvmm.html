<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hybrid Virtual Memory Manager</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #121212; color: white; }
        .memory-container { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
        .memory-section { width: 250px; padding: 10px; background: #1e1e1e; border-radius: 10px; box-shadow: 2px 2px 10px rgba(255, 255, 255, 0.1); }
        .block { width: 100%; height: 30px; margin: 5px 0; text-align: center; line-height: 30px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: all 0.3s ease-in-out; }
        .in-use { background: linear-gradient(45deg, #87CEEB, #1E90FF); color: white; }
        .swap { background: linear-gradient(45deg, #FFB6C1, #FF69B4); }
        .cache { background: linear-gradient(45deg, #FFD700, #FFA500); }
        .highlight { background-color: yellow !important; }
        button, select, input { margin: 10px; padding: 10px; background: #333; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #555; }
        #log { margin-top: 20px; padding: 10px; background: #1e1e1e; border-radius: 10px; height: 200px; overflow-y: auto; text-align: left; }
    </style>
</head>
<body>
    <h1>Hybrid Virtual Memory Manager</h1>
    <div>
        <label for="algorithm">Choose Algorithm:</label>
        <select id="algorithm">
            <option value="fifo">FIFO</option>
            <option value="lifo">LIFO</option>
            <option value="lfu">LFU</option>
            <option value="mru">MRU</option>
            <option value="lru">LRU</option>
        </select>
        <button onclick="allocateProcess()">Allocate Process</button>
        <button onclick="accessProcess()">Access Process</button>
        <button onclick="addToCache()">Add to Cache</button>
        <button onclick="clearCache()">Clear Cache</button>
        <button onclick="simulateProcessReplacement()">Simulate Process Replacement</button>
    </div>

    <div class="memory-container">
        <div class="memory-section">
            <h3>Main Memory (RAM)</h3>
            <div id="ram"></div>
        </div>
        <div class="memory-section">
            <h3>Swap Space</h3>
            <div id="swap"></div>
        </div>
        <div class="memory-section">
            <h3>Cache</h3>
            <div id="cache"></div>
        </div>
    </div>
    
    <div id="log"><strong>System Log:</strong><br></div>

    <script>
        let ram = [];
        let swap = [];
        let cache = new Map();  // Stores process with priority level
        let processPool = Array.from({ length: 20 }, (_, i) => `P${i + 1}`);
        let ramSize = 4;
        let swapSize = 4;
        let cacheSize = 3;
        let processPriority = {}; 

        function getRandomProcess() {
            return processPool[Math.floor(Math.random() * processPool.length)];
        }

        function allocateProcess() {
            let process = getRandomProcess();
            let priority = Math.floor(Math.random() * 3) + 1; // 1-High, 2-Medium, 3-Low
            processPriority[process] = priority;

            if (ram.includes(process) || swap.includes(process)) {
                logEvent(`Process ${process} is already allocated.`);
                return;
            }

            if (ram.length < ramSize) {
                ram.push(process);
                logEvent(`Process ${process} (Priority ${priority}) allocated to RAM.`);
            } else {
                applyAlgorithm(process);
            }
            updateDisplay();
        }

        function applyAlgorithm(newProcess) {
            let algorithm = document.getElementById("algorithm").value;
            let removed;

            if (algorithm === "fifo") {
                removed = ram.shift();
            } else if (algorithm === "lifo") {
                removed = ram.pop();
            } else if (algorithm === "lfu") {
                removed = Object.keys(processPriority).sort((a, b) => processPriority[a] - processPriority[b])[0];
                ram.splice(ram.indexOf(removed), 1);
            } else if (algorithm === "mru") {
                removed = ram[ram.length - 1];
                ram.pop();
            } else if (algorithm === "lru") {
                removed = ram[0];
                ram.shift();
            }

            if (swap.length < swapSize) {
                swap.push(removed);
                logEvent(`Process ${removed} moved to Swap.`);
            }
            ram.push(newProcess);
            logEvent(`Process ${newProcess} allocated to RAM.`);
        }

        function addToCache() {
            let process = getRandomProcess();
            let priority = processPriority[process] || 2;

            if (cache.size >= cacheSize) {
                let leastPriority = [...cache.entries()].sort((a, b) => a[1] - b[1])[0][0];
                cache.delete(leastPriority);
                logEvent(`Cache full: Removed ${leastPriority} from cache.`);
            }

            cache.set(process, priority);
            logEvent(`Process ${process} added to cache (Priority ${priority}).`);
            updateDisplay();
        }

        function clearCache() {
            cache.clear();
            logEvent("Cache cleared.");
            updateDisplay();
        }

        function accessProcess() {
            let process = prompt("Enter process (P1-P20) to access:");
            if (ram.includes(process)) {
                highlightBlock("ram");
                logEvent(`Process ${process} accessed in RAM.`);
            } else if (swap.includes(process)) {
                logEvent(`Process ${process} found in Swap. Loading to RAM...`);
                if (ram.length < ramSize) {
                    ram.push(process);
                    swap.splice(swap.indexOf(process), 1);
                    logEvent(`Process ${process} moved from Swap to RAM.`);
                } else {
                    logEvent(`RAM full, cannot load ${process}.`);
                }
                updateDisplay();
            } else if (cache.has(process)) {
                highlightBlock("cache");
                logEvent(`Process ${process} accessed from Cache.`);
            } else {
                logEvent(`Page fault! Process ${process} not found.`);
            }
        }

        function updateDisplay() {
            document.getElementById("ram").innerHTML = ram.map(p => `<div class="block in-use">${p}</div>`).join("");
            document.getElementById("swap").innerHTML = swap.map(p => `<div class="block swap">${p}</div>`).join("");
            document.getElementById("cache").innerHTML = [...cache.keys()].map(p => `<div class="block cache">${p}</div>`).join("");
        }

        function logEvent(message) {
            let logDiv = document.getElementById("log");
            logDiv.innerHTML += `${new Date().toLocaleTimeString()} - ${message}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function highlightBlock(id) {
            document.getElementById(id).classList.add("highlight");
            setTimeout(() => document.getElementById(id).classList.remove("highlight"), 500);
        }

        updateDisplay();
    </script>
</body>
</html>

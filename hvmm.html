<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hybrid Virtual Memory Manager</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            background-color: #121212; /* Dark mode */
            color: white;
        }
        .memory-container { 
            display: flex; 
            justify-content: center; 
            gap: 20px; 
            margin-top: 20px; 
        }
        .memory-section { 
            width: 250px; 
            padding: 10px; 
            background: #1e1e1e; /* Dark grey */
            border-radius: 10px; 
            box-shadow: 2px 2px 10px rgba(255, 255, 255, 0.1); 
        }
        .block { 
            width: 100%; 
            height: 30px; 
            margin: 5px 0; 
            text-align: center; 
            line-height: 30px; 
            border-radius: 5px; 
            cursor: pointer; 
            transition: opacity 0.5s ease, background-color 0.5s ease; 
            font-weight: bold;
        }
        .in-use { background-color: #87CEEB; color: #000; }  /* Light Blue */
        .free { background-color: #D3D3D3; color: #000; }  /* Light Grey */
        .cache { background-color: #FFD700; color: #000; }  /* Gold */
        .swap { background-color: #FFB6C1; color: #000; }  /* Light Pink */
        .highlight { background-color: yellow !important; }
        
        button { 
            margin: 10px; 
            padding: 10px; 
            background: #333; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer;
        }
        button:hover { background: #555; }
        
        #log { 
            margin-top: 20px; 
            padding: 10px; 
            background: #1e1e1e; 
            border-radius: 10px; 
            box-shadow: 2px 2px 10px rgba(255, 255, 255, 0.1); 
            height: 200px; 
            overflow-y: auto; 
            text-align: left; 
        }
    </style>
</head>
<body>
    <h1>Hybrid Virtual Memory Manager</h1>
    <div>
        <button onclick="allocateProcess()">Allocate Process</button>
        <button onclick="accessProcess()">Access Process</button>
        <button onclick="addToCache()">Add to Cache</button>
        <button onclick="clearCache()">Clear Cache</button>
        <button onclick="simulatePageReplacement()">Simulate Process Replacement</button>
    </div>
    <div class="memory-container">
        <div class="memory-section">
            <h3>Main Memory (RAM)</h3>
            <div id="ram"></div>
        </div>
        <div class="memory-section">
            <h3>Swap Space</h3>
            <div id="swap"></div>
        </div>
        <div class="memory-section">
            <h3>Cache</h3>
            <div id="cache"></div>
        </div>
    </div>
    <div id="log"><strong>System Log:</strong><br></div>

    <script>
        let ram = [];
        let swap = [];
        let cache = new Set();
        let processPool = Array.from({ length: 20 }, (_, i) => `P${i + 1}`);
        let ramSize = 4;
        let swapSize = 4;

        function getRandomProcess() {
            return processPool[Math.floor(Math.random() * processPool.length)];
        }

        function allocateProcess() {
            let process = getRandomProcess();
            if (ram.includes(process) || swap.includes(process)) {
                logEvent(`Process ${process} is already allocated.`);
                return;
            }

            if (ram.length < ramSize) {
                ram.push(process);
                logEvent(`Process ${process} allocated to RAM.`);
            } else {
                let removed = ram.shift();
                if (swap.length < swapSize) {
                    swap.push(removed);
                    logEvent(`Process ${removed} moved to Swap.`);
                }
                ram.push(process);
                logEvent(`Process ${process} allocated to RAM.`);
            }
            updateDisplay();
        }

        function accessProcess() {
            let process = prompt("Enter process (P1-P20) to access:");
            if (ram.includes(process)) {
                highlightBlock("ram");
                logEvent(`Process ${process} accessed in RAM.`);
            } else if (swap.includes(process)) {
                logEvent(`Process ${process} found in Swap. Simulating disk access...`);
                setTimeout(() => {
                    if (ram.length < ramSize) {
                        ram.push(process);
                        swap.splice(swap.indexOf(process), 1);
                        logEvent(`Process ${process} moved from Swap to RAM.`);
                    } else {
                        logEvent(`Process ${process} could not be loaded due to RAM full.`);
                    }
                    updateDisplay();
                }, 1000); // Simulated disk access delay
            } else {
                logEvent(`Page fault! Process ${process} not found in RAM or Swap.`);
            }
        }

        function addToCache() {
            let process = getRandomProcess();
            if (cache.size >= 3) {
                let removed = Array.from(cache)[0];
                cache.delete(removed);
                logEvent(`Process ${removed} removed from cache.`);
            }
            cache.add(process);
            logEvent(`Process ${process} added to cache.`);
            updateDisplay();
        }

        function clearCache() {
            cache.clear();
            logEvent("Cache cleared.");
            updateDisplay();
        }

        function simulatePageReplacement() {
            if (ram.length > 0) {
                let replacedProcess = ram.shift();
                let newProcess = getRandomProcess();
                while (ram.includes(newProcess) || swap.includes(newProcess)) {
                    newProcess = getRandomProcess();
                }
                ram.push(newProcess);
                logEvent(`LRU Algorithm: Replaced Process ${replacedProcess} with ${newProcess}.`);
                updateDisplay();
            } else {
                logEvent("No processes in RAM to replace.");
            }
        }

        function updateDisplay() {
            document.getElementById("ram").innerHTML = ram.map(p => `<div class="block in-use">${p}</div>`).join("");
            document.getElementById("swap").innerHTML = swap.map(p => `<div class="block swap">${p}</div>`).join("");
            document.getElementById("cache").innerHTML = Array.from(cache).map(p => `<div class="block cache">${p}</div>`).join("");
        }

        function logEvent(message) {
            let logDiv = document.getElementById("log");
            logDiv.innerHTML += `${new Date().toLocaleTimeString()} - ${message}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function highlightBlock(id) {
            let element = document.getElementById(id);
            element.classList.add("highlight");
            setTimeout(() => {
                element.classList.remove("highlight");
            }, 500);
        }

        updateDisplay();
    </script>
</body>
</html>
